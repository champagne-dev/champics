<head>
	<link rel="stylesheet" href="styles.css">
	<script src="jquery-2.1.4.min.js"></script>
</head>
<body>
	<div id="postPanel">
		<div id="post">
			<img class="postImage" src="http://static.spin.com/files/150213-Drake-Lyrics.jpg"></img>
			<button id="submitEditBtn">Save</button>
		</div>
		<div id="options">

		</div>
	</div>
	<div id="commentPanel">
	</div>
	<script>
	



	var PostCanvas = function(){
		var self = this;
		this.init = function(){
			self.canvas = self.renderCanvas();
			self.ctx = self.canvas.getContext('2d');
			$("#submitEditBtn").click(function(){
				self.save();
			});
			self.runDraw();
		}

		this.renderCanvas = function() {
			var postImage = document.getElementsByClassName("postImage")[0];
			var postImageRect = postImage.getBoundingClientRect();
			var canvas = document.createElement('canvas');
			canvas.id     = "postCanvas";
			canvas.width  = postImage.clientWidth;
			canvas.height = postImage.clientHeight;
			canvas.style.top   = $(postImage).position().top;
			canvas.style.left   = $(postImage).position().left;
			canvas.style.zIndex   = 2;
			canvas.style.position = "absolute";
			document.body.appendChild(canvas);
			return canvas;
		}

		this.runDraw = function() {
			var canvas = self.canvas;
			var ctx = self.ctx;
			var fillColor = "red";
			var width = 200;
			var height = 200;
			// define a custom fillCircle method
			ctx.fillCircle = function(x, y, radius, fillColor) {
			    this.fillStyle = fillColor;
			    this.beginPath();
			    this.moveTo(x, y);
			    this.arc(x, y, radius, 0, Math.PI * 2, false);
			    this.fill();
			};
			ctx.clearTo = function(fillColor) {
			    ctx.fillStyle = fillColor;
			};
			ctx.clearTo(fillColor || "#ddd");

			// bind mouse events
			canvas.onmousemove = function(e) {
			    if (!canvas.isDrawing) {
			       return;
			    }
			    var x = e.pageX - this.offsetLeft;
			    var y = e.pageY - this.offsetTop;
			    var radius = 10; // or whatever
			    var fillColor = '#ff0000';
			    ctx.fillCircle(x, y, radius, fillColor);
			};
			canvas.onmousedown = function(e) {
			    canvas.isDrawing = true;
			};
			canvas.onmouseup = function(e) {
			    canvas.isDrawing = false;
			};	
		}
		
		this.save = function() {
			console.log(self.canvas.toDataURL("image/png"));
		}
		self.init();
	}

	var pc = new PostCanvas();


	</script>
</body>